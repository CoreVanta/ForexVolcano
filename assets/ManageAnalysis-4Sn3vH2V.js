import{r as l,h as D,q as T,c as g,d as o,o as S,g as E,j as e,B as b,e as p,b as C,a as B,k as P,l as R,m as U,n as q}from"./index-CdHir_gS.js";import{R as F}from"./quill.snow-DlSDnkDK.js";const I={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],["link","image"],["clean"]]},L=["header","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","color","background"],M=()=>{const[m,f]=l.useState([]),[j,y]=l.useState(!0),[c,x]=l.useState(!1),[d,u]=l.useState(null),[s,a]=l.useState({title:"",pair:"EUR/USD",direction:"Neutral",content:"",image:"",analysisType:"Technical Analysis"}),[w,N]=l.useState({});l.useEffect(()=>{h();const t=D(B,async r=>{if(r)try{const i=p(o,"users",r.uid),n=await C(i);n.exists()&&N(n.data())}catch(i){console.error("Error fetching profile:",i)}});return()=>t()},[]);const h=async()=>{y(!0);try{const t=T(g(o,"analysis"),S("timestamp","desc")),i=(await E(t)).docs.map(n=>({id:n.id,...n.data()}));f(i)}catch(t){console.error("Error fetching analysis:",t)}finally{y(!1)}},v=async t=>{if(window.confirm("Are you sure you want to delete this analysis?"))try{await q(p(o,"analysis",t)),h()}catch(r){console.error("Error deleting post:",r),alert("Failed to delete post.")}},k=async t=>{t.preventDefault();const r={...s,...w,timestamp:R()};try{d?await P(p(o,"analysis",d),r):await U(g(o,"analysis"),r),x(!1),u(null),a({title:"",pair:"EUR/USD",direction:"Neutral",content:"",image:"",analysisType:"Technical Analysis"}),h()}catch(i){console.error("Error saving post:",i),alert("Failed to save analysis.")}},A=t=>{a({title:t.title,pair:t.pair,direction:t.direction,content:t.content,image:t.image,analysisType:t.analysisType||"Technical Analysis"}),u(t.id),x(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Manage Analysis"}),e.jsx(b,{onClick:()=>{x(!c),c&&(u(null),a({title:"",pair:"EUR/USD",direction:"Neutral",content:"",image:"",analysisType:"Technical Analysis"}))},children:c?"Cancel":"New Analysis"})]}),c&&e.jsxs("div",{className:"bg-surface p-6 rounded-xl border border-gray-800 mb-8 animate-fade-in",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:d?"Edit Analysis":"Post Technical Breakdown"}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Pair / Asset"}),e.jsx("input",{type:"text",required:!0,className:"w-full bg-background border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-primary focus:outline-none uppercase",value:s.pair,onChange:t=>a({...s,pair:t.target.value}),placeholder:"e.g. GBP/JPY"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Direction"}),e.jsxs("select",{className:"w-full bg-background border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-primary focus:outline-none",value:s.direction,onChange:t=>a({...s,direction:t.target.value}),children:[e.jsx("option",{value:"Neutral",children:"Neutral (Gray)"}),e.jsx("option",{value:"Bullish",children:"Bullish (Green)"}),e.jsx("option",{value:"Bearish",children:"Bearish (Red)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Analysis Type"}),e.jsxs("select",{className:"w-full bg-background border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-primary focus:outline-none",value:s.analysisType,onChange:t=>a({...s,analysisType:t.target.value}),children:[e.jsx("option",{value:"Technical Analysis",children:"Technical Analysis"}),e.jsx("option",{value:"Fundamental Analysis",children:"Fundamental Analysis"}),e.jsx("option",{value:"Sentiment Analysis",children:"Sentiment Analysis"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Image URL (Chart)"}),e.jsx("input",{type:"url",className:"w-full bg-background border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-primary focus:outline-none",value:s.image,onChange:t=>a({...s,image:t.target.value}),placeholder:"https://..."})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title"}),e.jsx("input",{type:"text",required:!0,className:"w-full bg-background border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-primary focus:outline-none",value:s.title,onChange:t=>a({...s,title:t.target.value}),placeholder:"e.g. Double Top formation on 4H"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Analysis Content"}),e.jsx("div",{className:"bg-white rounded-lg overflow-hidden text-black",children:e.jsx(F,{theme:"snow",value:s.content,onChange:t=>a({...s,content:t}),modules:I,formats:L,className:"h-96 mb-12"})})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(b,{type:"submit",variant:"primary",children:d?"Update Analysis":"Post Analysis"})})]})]}),e.jsx("div",{className:"bg-surface rounded-xl border border-gray-800 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-800",children:[e.jsx("thead",{className:"bg-gray-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Pair"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Direction"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:j?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-400",children:"Loading data..."})}):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-400",children:"No analysis posted yet."})}):m.map(t=>e.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.timestamp?.seconds?new Date(t.timestamp.seconds*1e3).toLocaleDateString():"Just now"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-bold",children:t.pair}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                        ${t.direction==="Bullish"?"bg-green-500/20 text-green-400":t.direction==="Bearish"?"bg-red-500/20 text-red-400":"bg-gray-700 text-gray-300"}`,children:t.direction})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white max-w-xs truncate",children:t.title}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>A(t),className:"text-primary hover:text-primary/80 transition-colors mr-4",children:"Edit"}),e.jsx("button",{onClick:()=>v(t.id),className:"text-red-400 hover:text-red-300 transition-colors",children:"Delete"})]})]},t.id))})]})})})]})};export{M as default};
